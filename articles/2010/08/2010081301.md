title: iPhone的多任务有多占资源？后台程序有多耗费电池？半专业的分析一下……
date: 2010-08-13 15:33:42
---

    大家都知道iPhone4.0系统添加了多任务功能，很新奇吗？其实也不是，Android因为基于Linux，WM系统基于WinCE内核都是默认支持多任务的，所以iPhone有这种功能也不能算什么。
    多任务等于多进程吗？不对，因为iPhone的内核应该是多进程，多线程的，因为必须有多种后台程序运行嘛，就算再简单，作为智能手机也要有电话和短信程序同时监听吧。而之所以iPhone之前不支持多任务，只是不支持用户的、第三方程序的后台同时运行而已，并不代表不支持多进程。
    多任务或者说多进程，或者说多线程，和CPU有关吗？关系有，但是不大，单CPU，就算没有什么所谓的超线程技术，也可以“同时运行多个进程”的，因为CPU太快了，所以可以模仿着，在很短时间内轮流运行进程，好像是同时运行一样。
    有的同学说iPhone后台有程序，肯定占用了更多内存，所以肯定更耗电。这个吧，虽然我对现代内存设计没有太多了解，但是我仅有的专业知识来看，硬盘或者内存，无论是什么介质的，其中已占有空间的大小，几乎不会影响耗电。内存更别提了，动态内存无论里面有没有内容，都要每隔几毫秒就刷新的，我想如果把内存分块然后单独管理电源……那可能得不偿失吧，所以内存占用多寡，肯定不会影响耗电。
    那么说后台程序不会增加耗电？也不会，因为后台程序可能会占用CPU和其他芯片导致耗电。比如说如果，虽然现在还没有，如果QQ可以在iPhone上后台运行，肯定也不会一动不动吧？肯定也会不断的从服务器收发信息吧，这样自然就会因为多使用了CPU和网络芯片资源，而可能增加耗电。为什么是说可能呢？因为CPU除非关了它，那也就是彻底关机了；否则肯定都是有一定耗电的，虽然现在移动CPU是会自动降频来省电，但是降频不可能降低到0，如果降低到的频率已经可以满足如QQ此类程序的通信需要，那么就不需要自动升频，也就是有QQ没QQ的CPU耗电应该是一样的。其他通信芯片类似。
    我倒是觉得与其去担心这些后台程序耗电，还不如多关关屏幕……因为屏幕一般都是最耗电的。
    另一个命题：存储空间影响运算速度吗？有可能，但是即使有，也不大。为什么说有可能，是因为传统的机械硬盘和一般的分区结构，无论再怎么优化，都会出现离散的不连续的数据，对这些数据做连续读取传统硬盘肯定会增加时间，间接当然也增加耗电。不过随机读取对于Flash和内存来说，区别并不大，所以也不可能因为这种原因而增加程序运算速度，至少不会影响到人能察觉到的水平。
    还有一个观点认为iPhone需要使用存储器作为交换区来代替内存，所以必须保证可用存储区很大才能保证运算速度，这种观点非常明显是错误的。无论是Windows的页面文件，Linux的swap分区，还是Windows Mobile，这些是我知道的，并且他们都有自己的独占的交换分区。因为硬盘数据可能会经常变换，所以操作系统自然很喜欢一个固定的交换分区作为内存的代替。当然你可以说Windows的页面文件也是可以变的啊，可是就算那样也是有上限的，并不是简单而随意的。更何况，假设iPhone的内核真的使用了用户空间作为交换分区，那反而是个蠢主意，因为为什么要用交换分区？很简单因为内存不够用，作为手机来讲虽然内存并不多，但是占用内存的大都是第三方非重要的程序，自然清除这些在后台占用内存的程序是最快的办法咯？要知道存储器的速度可是比内存慢的多的多，而且读取和写如存储器也需要消耗大量的总线时间，对于用户来说就是用户体验的缺失。显然如果我是苹果的工程师我会更喜欢将那些不重要的、优先级较低的程序清出内存这么方便的做法，而不是费力去考虑动态可变的存储器的交换区。现在内存价格便宜，容量大，速度快；而交换区是以前内存很贵，容量很小的时候的选择，如果现在还要用这种过时的技术真的只能算下下策。