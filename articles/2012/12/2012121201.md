title: 英语在线学习系统·HTML5使用简谈
date: 2012-12-12 21:47:40
---

ESOL使用了几个HTML5，现在主要是LocalStorage，Application Cache，Worker，本来还想用Web Database，不过现在很多浏览器都不支持，对IndexDB的支持也有限，好再可以用LocalStorage代替。

LocalStorage能存储一个string，我就把JSON作为数据库，反正JSON作为数据库的感觉就好像是Mongodb一样，然后再把JSON字符串化存储在LocalStorage，读取的时候再从字符串转换回JSON，整个过程也是很流畅的，加个中间层基本上感觉不出来什么。

Application Cache我觉得各个浏览器之间还是有些问题了，因为程序很难一次就发布成功嘛，而如果修改，各个浏览器对于这东西的支持感觉并不好，Firefox有时候要刷新3次才能刷新出来新的Cache发布，IE有时候会出现错误，只能通过删除缓存来解决。

Worker是最后加入的，用来多线程处理解压缩，不过Worker也有问题，例如和主体JS是独立的，也就是说Worker不能调用其他js的库和函数，而除了worker以外的都是通用的。所以没办法我就把worker必须的东西再复制一份出来进入worker。如果要模块化可能就要worker调用另一个worker，或者ajax来获取其他的js，总之是很麻烦的事情。

除了HTML5，我还是用了LZMA算法将字典文件压缩，可以把2MB多的文件压缩到1MB以内，还是很大的改善的。使用的第三方库比较少，无非是jquery，jqueryui，headjs，headjs是为了异步的获取js，和jquery配合来获得良好的用户体验，毕竟整个程序达到2MB，要下载也很麻烦。下一步考虑用多线程下载所有的js文件，进一步提高工作效率。